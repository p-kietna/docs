You're getting a TypeScript error because you're trying to push a flat array (`failed: { partNumber: number; url: string }[]`) into a nested array (`queue: { partNumber: number; url: string }[][]`).

---

### 🧠 Why It Fails

- `queue` is an array of arrays: `Array<Array<{ partNumber: number; url: string }>>`
- `failed` is a flat array: `Array<{ partNumber: number; url: string }>`

So when you do:

```ts
queue.push(...failed); // ❌ Type mismatch
```

TypeScript expects each item to be an array, not an object.

---

### ✅ How to Fix It

Wrap `failed` in another array before pushing:

```ts
queue.push(failed); // ✅ This works
```

Or if you want to push each failed item as its own chunk:

```ts
failed.forEach(f => queue.push([f])); // ✅ Push each as a single-item chunk
```

---

### 🔍 Choose Based on Intent

| Goal                          | Code                        |
|------------------------------|-----------------------------|
| Retry all failed files as one chunk | `queue.push(failed)`         |
| Retry each failed file separately  | `failed.forEach(f => queue.push([f]))` |

Let me know which retry strategy you're aiming for — I can help you optimize the queue logic or add retry limits.